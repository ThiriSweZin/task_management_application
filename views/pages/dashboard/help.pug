extends ../../includes/layout-dashboard

block content
    ol.breadcrumb
        li.breadcrumb-item
            a(href="/dashboard") Home
        li.breadcrumb-item
            a(href="/help") Help
        li.breadcrumb-item.active
            span Help Information
    h1.page-header Help Information
    div.row.from-wrapper
        div.alert.alert-dismissible#alert(role='alert')
            strong.alert-title#alertTitle
            span#alertMessage
            button.close(type='button', data-hide='alert', aria-label='Close')
                span(aria-hidden='true') &times;

        form.form-horizontal#entryForm(method='post', action=`${postUrl}`, enctype="application/x-www-form-urlencoded")
            input#recordid(type='hidden', name='id', value=params.id)
            input#createddate(type='hidden', name='createddate', value=params.createddate)

            div.form-group.row
                label.col-sm-2.control-label.mm(for='wholesalephone') လက်ကားအရောင်းဌာန
                div.col-sm-10
                    input.form-control.mm.info#wholesale_phone(type="text", name="wholesale_phone", value=params.wholesale_phone, data-role="tagsinput", required)

            div.form-group.row
                label.col-sm-2.control-label(for='customerservicephone') Customer Service
                div.col-sm-10
                    input.form-control.mm.info#customerservice_phone(type="text", name="customerservice_phone", value=params.customerservice_phone, data-role="tagsinput", required)
                    
            div.row.justify-content-center.form-actions
                button.btn.btn-primary#submitBtn(type='submit', role='button') Save
                a.btn.btn-secondary#actionCancel(href=listUrl, role='button') Cancel

        form#postSuccessForm(method='GET', action=listUrl)
        
    script(src='/js/upload.js')
    script(src='/js/scripts-upload.js')
    script.
        $(document).ready(function() {
            var token = "!{token}";
            $('div.sidebar-sticky li.nav-item').removeClass('active');
            $('li#menu-help').addClass('active');
            $('div#general_subitems').addClass('show');

            $("#alert").hide();
            var access = ("#{permission.access}").split(",");
            if (access[1] != "1") {
                $("#submitBtn").hide();
                var info = document.getElementsByClassName("info");
                for (var index = 0; index < info.length; ++index) {
                    info[index].setAttribute("disabled", "");
                }
            }

            $('#entryForm').submit(function(event) {
                event.preventDefault();

                $.ajax({
                    url: $(this).attr("action"),
                    type: $(this).attr("method"),
                    data: $(this).formSerialize(),
                    contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                    processData: false,
                    success: function(data) {
                        if (data.success) {
                            $("#alertTitle").html("Success");
                            $("#alertMessage").html("Save Success!");
                            $("#alert").addClass("alert-success").show();

                            var postFrm = $('#postSuccessForm');
                            var params = $.url(postFrm.attr('action')).param();
                            if (!params) {
                                for (var key in params) {
                                    postFrm.append($('<input type="hidden" name="' + key + '" value="' + params[key] + '" />'));
                                }
                            }
                            window.setTimeout(function() {
                                postFrm.submit();
                            }, 2 * 1000);

                        } else {
                            $("#alertTitle").html("Error");
                            $("#alertMessage").html("Error on save!");
                            $("#alert").addClass("alert-danger").show();
                        }
                    }
                });
            });
        });